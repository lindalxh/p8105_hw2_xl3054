---
title: "p8105_hw2_xl3054"
author: "Xinhui Lin (xl3054)"
date: "2025-10-02"
output: github_document
---

# Problem 1
```{r}
library(tidyverse)
## pols_month
pols_month = read_csv(file = "./P1 data/pols-month.csv") %>%  ## load data
  janitor::clean_names() %>%  ## clean data
  separate(mon, into = c("year", "month", "day"), sep = "-") %>%  ## break up variable
  mutate(across(c(year, month, day), as.integer)) %>%  ## convert to integers
  mutate(month = month.name[month]) %>%  ## replace with month name
  mutate(president = case_when(prez_gop == 1 ~ "gop", 
                               prez_dem == 1 ~ "dem")) %>%  ## prez_dem and prez_gop into president
  select(-prez_gop, -prez_dem, -day)  ## remove variables

## snp
snp = read_csv(file = "./P1 data/snp.csv") %>%  ## load data
  janitor::clean_names() %>%  ## clean data
  separate(date, into = c("month", "day", "year"), sep = "/") %>%  ## break up variable
  mutate(across(c(year, month, day), as.integer)) %>%  ## convert to integers
  mutate(month = month.name[month]) %>%  ## replace with month name
  select(year, everything()) %>%  ## move year as leading
  select(-day) %>%  ## remove day
  mutate(year = if_else(year < 50, year + 2000, year + 1900))  ## make year consistent with previous

## unemployment
unemployment = read_csv(file = "./P1 data/unemployment.csv") %>%  ## load data
  janitor::clean_names() %>%  ## clean data
  rename_with(
    ~ month.name[match(., tolower(month.abb))],
    .cols = any_of(tolower(month.abb))) %>%  ## rename month to full names
  pivot_longer(cols = -year, 
               names_to = "month", 
               values_to = "unemp_rate")  ## switch from wide to long format

## merging datasets
join_12 = left_join(pols_month, snp, by = c("year", "month"))

join_123 = left_join(join_12, unemployment, by = c("year", "month"))
```

The `pols_month` dataset contains `r nrow(pols_month)` observations with variables describing the number of democratic and republican governors and senators from `r min(pull(pols_month, year))` to `r max(pull(pols_month, year))`. The `president` variable indicates whether the president was republican or democratic in each year. The `snp` dataset contains `r nrow(snp)` observations with the variable `close` on the closing values of the Standard & Poorâ€™s stock index from `r min(pull(snp, year))` to `r max(pull(snp, year))`. The `unemployment` dataset contains the `unemp_rate` variable, which indicates the unemployment rate in each month from `r min(pull(unemployment, year))` to `r max(pull(unemployment, year))`. The combined dataset `join_123` contains `r nrow(join_123)` observations and `r ncol(join_123)` columns in total, which includes variables for number of democratic and republican politicians, closing values of the S&P stock index, and monthly unemployment rate from `r min(pull(join_123, year))` to `r max(pull(join_123, year))`.


# Problem 2
```{r}
## mr trash wheel
library(readxl)
mr_trash = read_excel("./P2 data/202509 Trash Wheel Collection Data.xlsx", sheet = 1, skip = 1) %>%  ## load data
  janitor::clean_names() %>%  ## clean data
  drop_na(dumpster) %>%  ## remove na rows "total"
  select(-c(15, 16)) %>%  ## remove notes columns
  mutate(sports_balls = as.integer(round(sports_balls))) %>%  ## round & convert
  mutate(year = as.double(year)) ## convert year to integer for combining

## prof trash wheel
prof_trash = read_excel("./P2 data/202509 Trash Wheel Collection Data.xlsx", sheet = 2, skip = 1) %>%  ## load data
  janitor::clean_names() %>% ## clean data
  drop_na(dumpster)  ## remove na rows "total"

## gwynnda trash wheel
gwynnda_trash = read_excel("./P2 data/202509 Trash Wheel Collection Data.xlsx", sheet = 4, skip = 1) %>%  ## load data
  janitor::clean_names() %>%  ## clean data
  drop_na(dumpster)  ## remove na rows "total"

## combining datasets
combined_trash = bind_rows(mr_trash, prof_trash, gwynnda_trash)
```


In the combined dataset `combined_trash`, there are `r nrow(combined_trash)` observations in total. The dataset shows dates from `r min(combined_trash$date)` to `r max(combined_trash$date)`.


`r sum(prof_trash_clean$weight_tons)`

########## Write a paragraph about these data; you are encouraged to use inline R. Be sure to note the number of observations in the resulting dataset, and give examples of key variables. For available data, what was the total weight of trash collected by Professor Trash Wheel? What was the total number of cigarette butts collected by Gwynnda in June of 2022?

 


# Problem 3
```{r}
## load and clean data
zip_codes = read_csv(file = "./P3 data/Zip Codes.csv") %>% 
  janitor::clean_names() 

zori = read_csv(file = "./P3 data/Zip_zori_uc_sfrcondomfr_sm_month_NYC.csv") %>% 
  janitor::clean_names() %>% 
  pivot_longer(cols = starts_with("x"),
    names_to = "date",
    values_to = "zori") %>% 
  mutate(date = str_remove(date, "^x")) %>% 
  select(year, everything()) %>%  

inner_join(zip_codes, zori, by = c("zip_code" = "region_name"))

n_distinct(zip_codes$zip_code)
```







